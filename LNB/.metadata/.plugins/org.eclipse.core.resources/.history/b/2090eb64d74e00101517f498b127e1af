package DLL;

import java.sql.Connection;
import java.sql.Date;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.time.LocalDate;
import java.util.LinkedList;

import BLL.Articulo;
import BLL.Equipo;

public class DLLEquipo {
	private static Connection con = Conexion.getInstance().getConnection();

	// CREAR EQUIPO
	public static boolean crearEquipo(Equipo equipo) {
		boolean flag = false;

		try {
			PreparedStatement stmt = con.prepareStatement(
					"INSERT INTO equipos (nombre, ciudad, estadio, fecha_de_fundacion, temporadas_en_liga, campeonatos) VALUES (?, ?, ?, ?, ?, ?)");
			stmt.setString(1, equipo.getNombre());
			stmt.setString(2, equipo.getCiudad());
			stmt.setString(3, equipo.getEstadio());
			stmt.setString(4, equipo.getFechaDeFundacion());
			stmt.setInt(5, equipo.getTemporadasEnLiga());
			stmt.setInt(6, equipo.getCampeonatos());

			int filas = stmt.executeUpdate();
			if (filas > 0) {
				System.out.print("Equipo cargado correctamente.");
				flag = true;
			}
		} catch (Exception e) {
			e.printStackTrace();
		}

		return flag;
	}

	// LISTAR EQUIPOS
	public static LinkedList<Equipo> mostrarEquipos() {
	    LinkedList<Equipo> equipos = new LinkedList<>();

	    try {
	        PreparedStatement stmt = con.prepareStatement("SELECT * FROM equipos");
	        ResultSet rs = stmt.executeQuery();

	        while (rs.next()) {
	           
	            
	            String nombre = rs.getString("nombre");
	            String ciudad = rs.getString("ciudad");
	            String estadio = rs.getString("estadio");  
	            String fecha = rs.getString("fecha_de_fundacion");
	            int temporadas = rs.getInt("temporadas_en_liga");
	            int campeonatos = rs.getInt("campeonatos"); 

	            equipos.add(new Equipo(nombre,ciudad,estadio,fecha,temporadas,campeonatos));
	        }

	        rs.close();
	        stmt.close();
	    } catch (Exception e) {
	        e.printStackTrace();
	    }

	    return equipos;
	}
	// EDITAR EQUIPO

	
	
	
	// ELIMINAR EQUIPO
	public static boolean eliminarEquipo(Equipo equipo) {
	    boolean flag = false;

	    try {
	        PreparedStatement stmt = con.prepareStatement("DELETE FROM equipos WHERE nombre = ?");
	        stmt.setString(1, equipo.getNombre());

	        int filas = stmt.executeUpdate();
	        if (filas > 0) {
	            System.out.println("Equipo eliminado correctamente.");
	            flag = true;
	        }

	        stmt.close();
	    } catch (Exception e) {
	        e.printStackTrace();
	    }

	    return flag;
	}

}
