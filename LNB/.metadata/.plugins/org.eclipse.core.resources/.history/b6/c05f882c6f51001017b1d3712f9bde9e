package BLL;




import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.LinkedList;

import javax.swing.JOptionPane;


import DLL.DLLAficionado;
import repository.Encriptador;
import repository.Juegos;

public class Aficionado extends Usuario implements Encriptador, Juegos {

	// Atributos
	private String email;
	private String dOfBirth;
	private LinkedList<Jugador> quintetoIdeal;
	private Jugador jugadorFavorito;
	private Equipo equipoFavorito;
	private int puntos;

	

	// Constructores
	public Aficionado(String nombre, String apellido, String id, String pass, String email, String dOfBirth,
			LinkedList<Jugador> quintetoIdeal, Jugador jugadorFavorito, Equipo equipoFavorito, int puntos) {
		super(nombre, apellido, id, pass);
		this.email = email;
		this.dOfBirth = dOfBirth;
		this.quintetoIdeal = quintetoIdeal;
		this.jugadorFavorito = jugadorFavorito;
		this.equipoFavorito = equipoFavorito;
		this.puntos = puntos;
	}

	public Aficionado(String nombre, String apellido, String id, String pass, String email, String dOfBirth,
			Jugador jugadorFavorito, Equipo equipoFavorito, int puntos) {
		super(nombre, apellido, id, pass);
		this.email = email;
		this.dOfBirth = dOfBirth;
		this.jugadorFavorito = jugadorFavorito;
		this.equipoFavorito = equipoFavorito;
		this.puntos = puntos;
	}

	public Aficionado(String nombre, String apellido, String id, String pass, String email, String dOfBirth) {
		super(nombre, apellido, id, pass);
		this.email = email;
		this.dOfBirth = dOfBirth;
	}
	
	public Aficionado(String nombre, String apellido, String id, String pass, String email, String dOfBirth, int puntos) {
		super(nombre, apellido, id, pass);
		this.email = email;
		this.dOfBirth = dOfBirth;
		this.puntos = puntos;
	}

	public Aficionado() {

	}

	// Setters & Getters

	public String getEmail() {
		return email;
	}

	public void setEmail(String email) {
		this.email = email;
	}

	public String getdOfBirth() {
		return dOfBirth;
	}

	public void setdOfBirth(String dOfBirth) {
		this.dOfBirth = dOfBirth;
	}

	public LinkedList<Jugador> getQuintetoIdeal() {
		return quintetoIdeal;
	}

	public void setQuintetoIdeal(LinkedList<Jugador> quintetoIdeal) {
		this.quintetoIdeal = quintetoIdeal;
	}

	public Jugador getJugadorFavorito() {
		return jugadorFavorito;
	}

	public void setJugadorFavorito(Jugador jugadorFavorito) {
		this.jugadorFavorito = jugadorFavorito;
	}

	public Equipo getEquipoFavorito() {
		return equipoFavorito;
	}

	public void setEquipoFavorito(Equipo equipoFavorito) {
		this.equipoFavorito = equipoFavorito;
	}

	public int getPuntos() {
		return puntos;
	}

	public void setPuntos(int puntos) {
		this.puntos = puntos;
	}

	// Otros Métodos
	public static Aficionado login(String id, String pass) {

		Aficionado user = new Aficionado();

		if (id.isEmpty() || pass.isEmpty()) {
			System.out.print("No se permiten campos vacíos");

		} else {
			user = DLLAficionado.login(id, pass);

		}
		return user;

	}
	
	

	public static Aficionado registro(String nombre, String apellido, String id, String pass, String pass2,
			String email, String dOfBirth) {

		Aficionado nuevo = null;

		if (nombre.isEmpty() || apellido.isEmpty() || id.isEmpty() || pass.isEmpty() || pass2.isEmpty()
				|| email.isEmpty() || dOfBirth.isEmpty()) {

			System.out.print("No se permiten campos vacíos");

		} else {
			if (!pass.equals(pass2)) {
				System.out.print("Las contraseñas no coinciden");

			} else {
				nuevo = DLLAficionado.registro(nombre, apellido, id, pass, email, dOfBirth);

			}

		}
		return nuevo;
	}
	
	

	public  LinkedList<Aficionado> mostrarAficionados() {
		LinkedList<Aficionado> aficionados = DLLAficionado.mostrarAficionados();
		
		for (Aficionado aficionado : aficionados) {
			if (aficionado.getId().equals(this.getId())) {
				aficionados.remove(aficionado);
			}
		}
		
		return aficionados;
	}
	
	//EDITAR AFICIONADO
	public static boolean editarAficionado(Aficionado editado, String id_viejo) {
		
		if (editado.getNombre() == null || editado.getApellido() == null || editado.getId() == null || 
				editado.getPass() == null || editado.getEmail() == null || editado.getdOfBirth() == null) {
			JOptionPane.showMessageDialog(null, "No se permiten campos vacíos");
			return false;
		} else {
			return(DLLAficionado.editarAficionado(editado, id_viejo));
		}
		
	}

	// VALIDAR USUARIO

	public boolean esValido() {
		return nombre != null && !nombre.isEmpty() && apellido != null && !apellido.isEmpty() && id != null
				&& dOfBirth != null && !dOfBirth.isEmpty() && !id.isEmpty() && email != null && !email.isEmpty()
				&& pass != null && !pass.isEmpty();
	}
	
	//CAMBIAR FORMATO DE FECHA
	public String cambiarFechaFormato() {
	    try {
	        SimpleDateFormat formatoUsuario = new SimpleDateFormat("dd-MM-yyyy");
	        SimpleDateFormat formatoBD = new SimpleDateFormat("yyyy-MM-dd");
	        Date fecha = formatoUsuario.parse(this.dOfBirth);
	        return formatoBD.format(fecha);
	    } catch (ParseException e) {
	        e.printStackTrace();
	        return null;
	    }
	}

	public boolean asignarJugadorFavorito(Jugador jugador) {
		boolean flag = false;
		if (DLLAficionado.asignarJugadorFavorito(this, jugador)) {
			this.setJugadorFavorito(jugador);
			flag = true;
		} 
		return flag;
	}
	
	public boolean asignarEquipoFavorito(Equipo equipo) {
		boolean flag = false;
		if (DLLAficionado.asignarEquipoFavorito(this, equipo)) {
			this.setEquipoFavorito(equipo);
			flag = true;
		} 
		return flag;
	}
	
	//SUMAR PUNTOS
	public boolean sumarPuntos(int cant) {
		boolean flag = false;
		if (DLLAficionado.sumarPuntos(this, cant)) {
			this.setPuntos(this.getPuntos()+cant);
			flag = true;
		}

		return flag;
	}
	
	//RESTAR PUNTOS
		public boolean restarPuntos(int cant) {
			boolean flag = false;
			
			 if (this.getPuntos() < cant) {
			        System.out.println("No se pueden restar más puntos de los que tiene el aficionado.");
			        return false;
			    }
			if (DLLAficionado.restarPuntos(this, cant)) {
				this.setPuntos(this.getPuntos()-cant);
				flag = true;
			}

			return flag;
		}

	// To String
	@Override
	public String toString() {
		return "Aficionado [email=" + email + ", dOfBirth=" + dOfBirth + ", quintetoIdeal=" + quintetoIdeal
				+ ", jugadorFavorito=" + jugadorFavorito + ", equipoFavorito=" + equipoFavorito + "]";
	}
}
